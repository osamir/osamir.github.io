<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C Assignmnet Mechatronics 2025</title>
    <!-- C Language Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 rx=%2220%22 fill=%22%2300599C%22/><text x=%2250%22 y=%2270%22 font-family=%22Arial, sans-serif%22 font-size=%2260%22 font-weight=%22bold%22 fill=%22white%22 text-anchor=%22middle%22>C</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Import Ace Editor for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.7/ace.js"></script>
    <style>
        html {
            scroll-behavior: smooth;
            /* FIX: Set padding exactly to header height (64px) to snap perfectly */
            scroll-padding-top: 64px; 
        }
        
        /* Adjust scroll padding for mobile: Header (64px) + Nav (60px) - Overlap (1px) approx 123px */
        @media (max-width: 768px) {
            html {
                scroll-padding-top: 124px;
            }
        }

        body, html { min-height: 100%; margin: 0; }
        /* Style the editor container */
        .ace_editor { 
            width: 100%;
            height: 100%;
            font-size: 14px;
            line-height: 1.5;
        }

        /* FIXED GUTTER WIDTH (0-99 lines) */
        /* Prevents layout shift when moving from line 9 to 10 */
        .fixed-gutter-mode .ace_gutter {
            width: 40px !important;
        }
        .fixed-gutter-mode .ace_scroller {
            left: 40px !important;
        }

        /* PRINTING STYLES */
        #printable-area { display: none; } /* Hidden on screen */

        @media print {
            /* Reset body/html for print to prevent blank pages */
            body, html {
                height: auto !important;
                min-height: 0 !important;
                margin: 0 !important;
                padding: 0 !important;
                overflow: visible !important;
            }

            /* Hide the main interactive app parts */
            header, #sidebar-container, #mobile-nav { 
                display: none !important; 
            }
            
            /* Ensure main layout is hidden or reset */
            #main-wrapper {
                display: none !important;
            }
            
            /* Show the static printable area */
            #printable-area { 
                display: block !important; 
                padding: 20px;
                font-family: monospace; /* Ensure code font */
            }

            /* Styling for the print layout */
            .print-section {
                margin-bottom: 20px;
                border: 1px solid #ccc;
                padding: 15px;
                border-radius: 4px;
            }
            .print-header {
                font-weight: bold;
                font-size: 16px;
                border-bottom: 2px solid #333;
                margin-bottom: 10px;
                padding-bottom: 5px;
                text-transform: uppercase;
            }
            .question-box {
                background-color: #f9fafb;
                padding: 15px;
                margin-bottom: 20px;
                border: 1px solid #e5e7eb;
            }
            pre {
                white-space: pre-wrap; /* Wrap long lines on paper */
                word-break: break-all;
                margin: 0;
            }
            
            /* Page break handling */
            .question-block {
                page-break-inside: avoid;
                margin-bottom: 40px;
                border-bottom: 1px dashed #ccc;
                padding-bottom: 20px;
            }

            /* SYNTAX HIGHLIGHTING FOR PRINT */
            .ace_comment { color: #808080; font-style: italic; }
            .ace_keyword, .ace_storage { color: #000088; font-weight: bold; }
            .ace_string { color: #aa0000; }
            .ace_constant { color: #880088; }
            .ace_support { color: #795da3; }
            .ace_identifier { color: #000000; }
            .ace_meta.ace_preprocessor { color: #795da3; }
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen font-sans">

    <!-- Header -->
    <header class="bg-gray-900 text-white p-4 flex items-center justify-between shadow-md shrink-0 z-30 sticky top-0 h-[64px]">
        <div class="flex items-center gap-2">
            <svg class="w-6 h-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/></svg>
            <h1 class="text-xl font-bold">Assignmnet <span class="text-sm font-normal text-gray-400"> (Piston API C Compiler)</span></h1>
        </div>
    </header>

    <div class="flex flex-col md:flex-row flex-grow" id="main-wrapper">
        
        <!-- FIX 2: Mobile Navigation (Dropdown for better space usage) -->
        <!-- Added -mt-[1px] and adjusted sticky top to 63px to remove 1px visual gap -->
        <nav id="mobile-nav" class="md:hidden bg-gray-800 text-white p-3 sticky top-[63px] -mt-[1px] z-20 shadow-sm border-b border-gray-700 h-[60px]">
            <div class="flex gap-3 px-1 items-center h-full">
                <div class="relative flex-grow">
                    <select onchange="window.location.hash = this.value" class="w-full bg-gray-700 text-white text-sm rounded px-3 py-2 outline-none border border-gray-600 appearance-none font-medium">
                        <option value="" disabled selected>Jump to Question...</option>
                        <option value="#q1-block">Q1: Grades Analysis</option>
                        <option value="#q2-block">Q2: Diamond Shape</option>
                        <option value="#q3-block">Q3: Matrix Diagonal</option>
                        <option value="#q4-block">Q4: Count Number 5</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-400">
                        <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                    </div>
                </div>
                <button onclick="prepareAndPrint()" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded shadow text-sm font-bold flex items-center gap-2 transition-colors whitespace-nowrap">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2-2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>
                    Print
                </button>
            </div>
        </nav>

        <!-- Sidebar (Desktop) -->
        <!-- WIDTH REDUCED from w-64 to w-48 -->
        <aside id="sidebar-container" class="hidden md:flex flex-col w-48 bg-gray-800 text-gray-300 border-r border-gray-700 sticky top-[64px] h-[calc(100vh-64px)] overflow-y-auto shrink-0">
            <div class="p-4 space-y-6">
                <div>
                    <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Navigation</h3>
                    <div class="space-y-2 text-sm">
                        <a href="#q1-block" class="block px-3 py-2 rounded hover:bg-gray-700 hover:text-white transition-colors">1. Grades</a>
                        <a href="#q2-block" class="block px-3 py-2 rounded hover:bg-gray-700 hover:text-white transition-colors">2. Diamond</a>
                        <a href="#q3-block" class="block px-3 py-2 rounded hover:bg-gray-700 hover:text-white transition-colors">3. Matrix</a>
                        <a href="#q4-block" class="block px-3 py-2 rounded hover:bg-gray-700 hover:text-white transition-colors">4. Count 5</a>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Actions</h3>
                    <button onclick="prepareAndPrint()" class="w-full bg-blue-600 hover:bg-blue-500 text-white px-3 py-2 rounded shadow transition flex items-center justify-center gap-2 font-bold text-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2-2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>
                        Print
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <!-- MAX-WIDTH INCREASED from max-w-5xl to max-w-7xl to reduce margins -->
        <main id="main-layout" class="flex-grow p-4 w-full max-w-7xl mx-auto">
            
            <!-- Main Card -->
            <div class="w-full bg-white rounded-lg shadow-xl border border-gray-300 flex flex-col overflow-hidden mb-10">
                
                <!-- Student Info Section -->
                <div class="bg-gray-100 p-6 border-b border-gray-300 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Student Name -->
                    <div>
                        <label for="student-name" class="block text-xs font-bold text-gray-700 uppercase mb-2">Student Name (Arabic)</label>
                        <input type="text" id="student-name" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 text-right" placeholder="أدخل اسم الطالب" dir="rtl">
                        <p id="name-error" class="text-red-600 text-xs mt-1 hidden text-right font-bold">الرجاء إدخال الأحرف العربية فقط</p>
                    </div>
                    <!-- Level -->
                    <div>
                        <label for="student-level" class="block text-xs font-bold text-gray-700 uppercase mb-2">Level</label>
                        <select id="student-level" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 bg-white">
                            <option value="" disabled selected>-- Select Level --</option>
                            <option value="000">000</option>
                            <option value="100">100</option>
                            <option value="200">200</option>
                            <option value="300">300</option>
                            <option value="400">400</option>
                        </select>
                        <p id="level-error" class="text-red-600 text-xs mt-1 hidden font-bold">Please select a level</p>
                    </div>
                </div>

                <!-- =========================== QUESTION 1 BLOCK =========================== -->
                <div id="q1-block">
                    <!-- Text -->
                    <div id="question-text-1" class="bg-gray-50 p-6 border-b border-gray-200">
                        <h2 class="text-lg font-bold text-gray-800 mb-2">Question 1</h2>
                        <p class="text-gray-700 mb-2 font-medium">
                            Write C program that reads the grades for a class of an arbitrary number (until you enter negative number) of students and calculate the following:
                        </p>
                        <ul class="list-disc list-inside text-gray-700 mb-3 pl-2 space-y-1 text-sm">
                            <li>The number of students who passed the exam (i.e Grade >= 60)</li>
                            <li>The number of students who failed the exam (i.e. Grade < 60)</li>
                            <li>The average grade for all the student’s grades</li>
                        </ul>
                        <p class="text-gray-600 text-sm italic">The output should be printed with appropriate prompt messages.</p>
                    </div>

                    <!-- Workspace 1 -->
                    <div class="flex flex-col md:flex-row h-auto md:h-[480px] border-b-4 border-gray-300">
                        <!-- Editor 1 -->
                        <div class="w-full md:w-1/2 flex flex-col border-b md:border-b-0 md:border-r border-gray-300 bg-white relative h-[320px] md:h-auto">
                            <div class="bg-white px-4 py-2 flex justify-between items-center border-b border-gray-200 z-10 shrink-0">
                                <span class="text-xs font-bold text-gray-500 uppercase tracking-wide">Source Code (main.c)</span>
                                <div class="flex gap-2">
                                    <button onclick="formatCode(1)" class="text-gray-600 hover:text-gray-900 hover:bg-gray-100 border border-gray-300 px-3 py-1 rounded shadow-sm transition flex items-center gap-1 font-medium text-xs">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line></svg>
                                        Format
                                    </button>
                                    <button onclick="runCode(1)" id="run-btn-1" class="bg-green-600 hover:bg-green-500 text-white px-3 py-1 rounded shadow-sm transition flex items-center gap-1 font-bold text-xs">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                        Run
                                    </button>
                                </div>
                            </div>
                            <div class="flex-grow relative">
                                <div id="editor1">#include &lt;stdio.h&gt;

int main() {
    // Write your logic here.
    return 0;
}</div>
                            </div>
                        </div>
                        <!-- IO 1 -->
                        <div class="w-full md:w-1/2 flex flex-col bg-gray-900 md:border-l border-gray-700 h-[400px] md:h-auto">
                            <div class="flex flex-col h-1/4 border-b border-gray-700">
                                <div class="bg-gray-800 px-4 py-2 text-xs font-bold text-gray-400 border-b border-gray-700 uppercase tracking-wide flex justify-between items-center shrink-0">
                                    <span>Standard Input (stdin)</span>
                                    <span class="text-[10px] text-gray-500 lowercase normal-case">Type inputs here before running</span>
                                </div>
                                <textarea id="stdin1" class="flex-grow bg-gray-900 text-white p-4 text-sm font-mono resize-none focus:outline-none placeholder-gray-600" placeholder="Enter your grades here separated by spaces..."></textarea>
                            </div>
                            <div class="flex flex-col h-3/4">
                                <div class="bg-gray-800 px-4 py-3 text-xs font-bold text-gray-400 border-b border-gray-700 flex justify-between items-center h-[45px] uppercase tracking-wide shrink-0">
                                    <span>Terminal Output</span>
                                    <span id="status-badge-1" class="hidden text-xs bg-yellow-600 text-white px-2 py-0.5 rounded">Compiling...</span>
                                </div>
                                <pre id="output1" class="flex-grow p-4 text-sm font-mono overflow-auto whitespace-pre-wrap text-green-400">Click "Run" to execute code...</pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- =========================== QUESTION 2 BLOCK =========================== -->
                <div id="q2-block">
                    <!-- Text -->
                    <div id="question-text-2" class="bg-gray-50 p-6 border-b border-gray-200">
                        <h2 class="text-lg font-bold text-gray-800 mb-2">Question 2</h2>
                        <p class="text-gray-700 mb-2 font-medium">
                            Write a C program to print a Diamond shape using *:
                        </p>
                        <pre class="font-mono text-sm text-gray-700 bg-white border border-gray-200 p-3 rounded mb-3 w-fit mx-auto leading-tight">
   *
  ***
 *****
*******
 *****
  ***
   *</pre>
                        <p class="text-gray-600 text-sm italic">
                            Hint: you can divide the shape into two distinct phases: generating the upper pyramid and subsequently generating the inverted lower pyramid.
                        </p>
                    </div>

                    <!-- Workspace 2 -->
                    <div class="flex flex-col md:flex-row h-auto md:h-[480px] border-b-4 border-gray-300">
                        <!-- Editor 2 -->
                        <div class="w-full md:w-1/2 flex flex-col border-b md:border-b-0 md:border-r border-gray-300 bg-white relative h-[320px] md:h-auto">
                            <div class="bg-white px-4 py-2 flex justify-between items-center border-b border-gray-200 z-10 shrink-0">
                                <span class="text-xs font-bold text-gray-500 uppercase tracking-wide">Source Code (main.c)</span>
                                <div class="flex gap-2">
                                    <button onclick="formatCode(2)" class="text-gray-600 hover:text-gray-900 hover:bg-gray-100 border border-gray-300 px-3 py-1 rounded shadow-sm transition flex items-center gap-1 font-medium text-xs">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line></svg>
                                        Format
                                    </button>
                                    <button onclick="runCode(2)" id="run-btn-2" class="bg-green-600 hover:bg-green-500 text-white px-3 py-1 rounded shadow-sm transition flex items-center gap-1 font-bold text-xs">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                        Run
                                    </button>
                                </div>
                            </div>
                            <div class="flex-grow relative">
                                <div id="editor2">#include &lt;stdio.h&gt;

int main() {
    // Write your Diamond shape logic here
    
    return 0;
}</div>
                            </div>
                        </div>
                        <!-- IO 2 -->
                        <div class="w-full md:w-1/2 flex flex-col bg-gray-900 md:border-l border-gray-700 h-[400px] md:h-auto">
                            <div class="flex flex-col h-full">
                                <div class="bg-gray-800 px-4 py-3 text-xs font-bold text-gray-400 border-b border-gray-700 flex justify-between items-center h-[45px] uppercase tracking-wide shrink-0">
                                    <span>Terminal Output</span>
                                    <span id="status-badge-2" class="hidden text-xs bg-yellow-600 text-white px-2 py-0.5 rounded">Compiling...</span>
                                </div>
                                <pre id="output2" class="flex-grow p-4 text-sm font-mono overflow-auto whitespace-pre-wrap text-green-400">Click "Run" to execute code...</pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- =========================== QUESTION 3 BLOCK =========================== -->
                <div id="q3-block">
                    <!-- Text -->
                    <div id="question-text-3" class="bg-gray-50 p-6 border-b border-gray-200">
                        <h2 class="text-lg font-bold text-gray-800 mb-2">Question 3</h2>
                        <p class="text-gray-700 mb-2 font-medium">
                            Write a C program that accepts a 5x5 matrix (2D array) as input from the user. The program should calculate and print the sum of the elements located on the secondary diagonal.
                        </p>
                        <p class="text-gray-600 text-sm italic mb-6">
                            The secondary diagonal consists of elements starting from the top-right corner to the bottom-left corner.
                        </p>
                        
                        <!-- Secondary Diagonal Diagram (Centered & Larger) -->
                        <div class="flex flex-col items-center bg-white p-4 border border-gray-300 rounded shadow-sm w-fit mx-auto">
                            <p class="text-xs text-gray-500 mb-3 font-bold uppercase tracking-wider">Example (3x3)</p>
                            <div class="grid grid-cols-3 gap-1 bg-gray-200 p-1 border border-gray-300">
                                <!-- Row 1 -->
                                <div class="w-12 h-12 bg-white flex items-center justify-center font-mono text-gray-400 text-xl">1</div>
                                <div class="w-12 h-12 bg-white flex items-center justify-center font-mono text-gray-400 text-xl">2</div>
                                <div class="w-12 h-12 bg-blue-50 border-2 border-blue-500 flex items-center justify-center font-mono font-bold text-blue-700 text-xl relative">
                                    3
                                    <div class="absolute -top-1.5 -right-1.5 w-3 h-3 bg-blue-500 rounded-full"></div>
                                </div>
                                
                                <!-- Row 2 -->
                                <div class="w-12 h-12 bg-white flex items-center justify-center font-mono text-gray-400 text-xl">4</div>
                                <div class="w-12 h-12 bg-blue-50 border-2 border-blue-500 flex items-center justify-center font-mono font-bold text-blue-700 text-xl">5</div>
                                <div class="w-12 h-12 bg-white flex items-center justify-center font-mono text-gray-400 text-xl">6</div>

                                <!-- Row 3 -->
                                <div class="w-12 h-12 bg-blue-50 border-2 border-blue-500 flex items-center justify-center font-mono font-bold text-blue-700 text-xl relative">
                                    7
                                    <div class="absolute -bottom-1.5 -left-1.5 w-3 h-3 bg-blue-500 rounded-full"></div>
                                </div>
                                <div class="w-12 h-12 bg-white flex items-center justify-center font-mono text-gray-400 text-xl">8</div>
                                <div class="w-12 h-12 bg-white flex items-center justify-center font-mono text-gray-400 text-xl">9</div>
                            </div>
                            <div class="text-blue-600 text-xs mt-3 font-semibold flex items-center gap-1">
                                <span>Secondary Diagonal</span>
                                <svg class="w-4 h-4 transform rotate-45" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
                            </div>
                        </div>
                    </div>

                    <!-- Workspace 3 -->
                    <div class="flex flex-col md:flex-row h-auto md:h-[480px]">
                        <!-- Editor 3 -->
                        <div class="w-full md:w-1/2 flex flex-col border-b md:border-b-0 md:border-r border-gray-300 bg-white relative h-[320px] md:h-auto">
                            <div class="bg-white px-4 py-2 flex justify-between items-center border-b border-gray-200 z-10 shrink-0">
                                <span class="text-xs font-bold text-gray-500 uppercase tracking-wide">Source Code (main.c)</span>
                                <div class="flex gap-2">
                                    <button onclick="formatCode(3)" class="text-gray-600 hover:text-gray-900 hover:bg-gray-100 border border-gray-300 px-3 py-1 rounded shadow-sm transition flex items-center gap-1 font-medium text-xs">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line></svg>
                                        Format
                                    </button>
                                    <button onclick="runCode(3)" id="run-btn-3" class="bg-green-600 hover:bg-green-500 text-white px-3 py-1 rounded shadow-sm transition flex items-center gap-1 font-bold text-xs">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                        Run
                                    </button>
                                </div>
                            </div>
                            <div class="flex-grow relative">
                                <div id="editor3">#include &lt;stdio.h&gt;

int main() {
    // Write your 2D Matrix logic here
    
    return 0;
}</div>
                            </div>
                        </div>
                        <!-- IO 3 -->
                        <div class="w-full md:w-1/2 flex flex-col bg-gray-900 md:border-l border-gray-700 h-[400px] md:h-auto">
                            <!-- Modified Input Section Height (h-2/5) -->
                            <div class="flex flex-col h-2/5 border-b border-gray-700">
                                <div class="bg-gray-800 px-4 py-2 text-xs font-bold text-gray-400 border-b border-gray-700 uppercase tracking-wide flex justify-between items-center shrink-0">
                                    <span>Standard Input (stdin)</span>
                                    <span class="text-[10px] text-gray-500 lowercase normal-case">Type matrix elements here (space separated)</span>
                                </div>
                                <textarea id="stdin3" class="flex-grow bg-gray-900 text-white p-4 text-sm font-mono resize-none focus:outline-none placeholder-gray-600" placeholder="Matrix input will appear here..."></textarea>
                            </div>
                            <!-- Modified Output Section Height (h-3/5) -->
                            <div class="flex flex-col h-3/5">
                                <div class="bg-gray-800 px-4 py-3 text-xs font-bold text-gray-400 border-b border-gray-700 flex justify-between items-center h-[45px] uppercase tracking-wide shrink-0">
                                    <span>Terminal Output</span>
                                    <span id="status-badge-3" class="hidden text-xs bg-yellow-600 text-white px-2 py-0.5 rounded">Compiling...</span>
                                </div>
                                <pre id="output3" class="flex-grow p-4 text-sm font-mono overflow-auto whitespace-pre-wrap text-green-400">Click "Run" to execute code...</pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- =========================== QUESTION 4 BLOCK =========================== -->
                <div id="q4-block">
                    <!-- Text -->
                    <div id="question-text-4" class="bg-gray-50 p-6 border-b border-gray-200">
                        <h2 class="text-lg font-bold text-gray-800 mb-2">Question 4</h2>
                        <p class="text-gray-700 mb-2 font-medium">
                            Write a C program to input 10 integer numbers and store them in an array, then count the number 5 appearance in the array using a function named <code class="bg-gray-200 px-1 rounded text-red-600">count5</code>.
                        </p>
                        <p class="text-gray-600 text-sm italic">
                            Hint: The prototype of the function should be <code class="bg-gray-100 px-1 rounded border border-gray-300">int count5(int arr[], int len);</code>
                        </p>
                    </div>

                    <!-- Workspace 4 -->
                    <div class="flex flex-col md:flex-row h-auto md:h-[480px]">
                        <!-- Editor 4 -->
                        <div class="w-full md:w-1/2 flex flex-col border-b md:border-b-0 md:border-r border-gray-300 bg-white relative h-[320px] md:h-auto">
                            <div class="bg-white px-4 py-2 flex justify-between items-center border-b border-gray-200 z-10 shrink-0">
                                <span class="text-xs font-bold text-gray-500 uppercase tracking-wide">Source Code (main.c)</span>
                                <div class="flex gap-2">
                                    <button onclick="formatCode(4)" class="text-gray-600 hover:text-gray-900 hover:bg-gray-100 border border-gray-300 px-3 py-1 rounded shadow-sm transition flex items-center gap-1 font-medium text-xs">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line></svg>
                                        Format
                                    </button>
                                    <button onclick="runCode(4)" id="run-btn-4" class="bg-green-600 hover:bg-green-500 text-white px-3 py-1 rounded shadow-sm transition flex items-center gap-1 font-bold text-xs">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                        Run
                                    </button>
                                </div>
                            </div>
                            <div class="flex-grow relative">
                                <div id="editor4">#include &lt;stdio.h&gt;

int count5(int arr[], int len){
    // Implement count5 here and change return 0
    return 0;
}

int main() {
    // Write your main logic here
    return 0;
}
</div>
                            </div>
                        </div>
                        <!-- IO 4 -->
                        <div class="w-full md:w-1/2 flex flex-col bg-gray-900 md:border-l border-gray-700 h-[400px] md:h-auto">
                            <div class="flex flex-col h-1/4 border-b border-gray-700">
                                <div class="bg-gray-800 px-4 py-2 text-xs font-bold text-gray-400 border-b border-gray-700 uppercase tracking-wide flex justify-between items-center shrink-0">
                                    <span>Standard Input (stdin)</span>
                                    <span class="text-[10px] text-gray-500 lowercase normal-case">Type 10 numbers here</span>
                                </div>
                                <textarea id="stdin4" class="flex-grow bg-gray-900 text-white p-4 text-sm font-mono resize-none focus:outline-none placeholder-gray-600" placeholder="1 5 2 5 3..."></textarea>
                            </div>
                            <div class="flex flex-col h-3/4">
                                <div class="bg-gray-800 px-4 py-3 text-xs font-bold text-gray-400 border-b border-gray-700 flex justify-between items-center h-[45px] uppercase tracking-wide shrink-0">
                                    <span>Terminal Output</span>
                                    <span id="status-badge-4" class="hidden text-xs bg-yellow-600 text-white px-2 py-0.5 rounded">Compiling...</span>
                                </div>
                                <pre id="output4" class="flex-grow p-4 text-sm font-mono overflow-auto whitespace-pre-wrap text-green-400">Click "Run" to execute code...</pre>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- Hidden Printable Area -->
    <div id="printable-area">
        <h1 style="text-align: center; margin-bottom: 20px;">C Assignmnet Mechatronics 2025</h1>
        
        <!-- Student Info (Valid for all) -->
        <div style="border: 2px solid #333; padding: 20px; margin-bottom: 30px; border-radius: 8px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="text-align: left;">
                    <span style="display: block; font-size: 12px; color: #666; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px;">Level</span>
                    <span id="print-student-level" style="font-size: 24px; font-weight: bold; color: #000;"></span>
                </div>
                <div style="width: 1px; height: 40px; background-color: #ddd; margin: 0 20px;"></div>
                <div style="text-align: right; flex-grow: 1;">
                    <span style="display: block; font-size: 12px; color: #666; margin-bottom: 5px;">اسم الطالب</span>
                    <span id="print-student-name" style="font-size: 22px; font-weight: bold; color: #000; direction: rtl; unicode-bidi: embed;"></span>
                </div>
            </div>
        </div>

        <!-- Question 1 Block -->
        <div class="question-block">
            <div class="question-box" id="print-question-content-1"></div>
            <div class="print-section">
                <div class="print-header">Source Code</div>
                <pre id="print-code-content-1"></pre>
            </div>
            <div class="print-section">
                <div class="print-header">Standard Input</div>
                <pre id="print-input-content-1"></pre>
            </div>
            <div class="print-section">
                <div class="print-header">Output</div>
                <pre id="print-output-content-1"></pre>
            </div>
        </div>

        <!-- Question 2 Block -->
        <div class="question-block">
            <div class="question-box" id="print-question-content-2"></div>
            <div class="print-section">
                <div class="print-header">Source Code</div>
                <pre id="print-code-content-2"></pre>
            </div>
            <div class="print-section">
                <div class="print-header">Output</div>
                <pre id="print-output-content-2"></pre>
            </div>
        </div>

        <!-- Question 3 Block -->
        <div class="question-block">
            <div class="question-box" id="print-question-content-3"></div>
            <div class="print-section">
                <div class="print-header">Source Code</div>
                <pre id="print-code-content-3"></pre>
            </div>
            <div class="print-section">
                <div class="print-header">Standard Input</div>
                <pre id="print-input-content-3"></pre>
            </div>
            <div class="print-section">
                <div class="print-header">Output</div>
                <pre id="print-output-content-3"></pre>
            </div>
        </div>

        <!-- Question 4 Block -->
        <div class="question-block">
            <div class="question-box" id="print-question-content-4"></div>
            <div class="print-section">
                <div class="print-header">Source Code</div>
                <pre id="print-code-content-4"></pre>
            </div>
            <div class="print-section">
                <div class="print-header">Standard Input</div>
                <pre id="print-input-content-4"></pre>
            </div>
            <div class="print-section">
                <div class="print-header">Output</div>
                <pre id="print-output-content-4"></pre>
            </div>
        </div>
    </div>

    <script>
        // --- INITIALIZE EDITORS ---
        var editor1 = ace.edit("editor1");
        editor1.setTheme("ace/theme/chrome"); 
        editor1.session.setMode("ace/mode/c_cpp"); 
        editor1.setShowPrintMargin(false);

        var editor2 = ace.edit("editor2");
        editor2.setTheme("ace/theme/chrome"); 
        editor2.session.setMode("ace/mode/c_cpp"); 
        editor2.setShowPrintMargin(false);

        var editor3 = ace.edit("editor3");
        editor3.setTheme("ace/theme/chrome"); 
        editor3.session.setMode("ace/mode/c_cpp"); 
        editor3.setShowPrintMargin(false);

        var editor4 = ace.edit("editor4");
        editor4.setTheme("ace/theme/chrome"); 
        editor4.session.setMode("ace/mode/c_cpp"); 
        editor4.setShowPrintMargin(false);

        // Helper for Fixed Gutter Mode
        function setupFixedGutter(editor) {
            if (editor.session.getLength() <= 99) {
                editor.container.classList.add("fixed-gutter-mode");
            }
            editor.session.on('change', function() {
                var lines = editor.session.getLength();
                if (lines > 99) {
                    editor.container.classList.remove("fixed-gutter-mode");
                } else {
                    editor.container.classList.add("fixed-gutter-mode");
                }
            });
        }
        setupFixedGutter(editor1);
        setupFixedGutter(editor2);
        setupFixedGutter(editor3);
        setupFixedGutter(editor4);

        // --- ARABIC VALIDATION ---
        document.getElementById('student-name').addEventListener('blur', function() {
            const input = this;
            const errorMsg = document.getElementById('name-error');
            const value = input.value.trim();
            const arabicRegex = /^[\u0600-\u06FF\s]+$/;

            if (value && !arabicRegex.test(value)) {
                input.classList.add('border-red-500', 'bg-red-50');
                input.classList.remove('border-gray-300', 'focus:border-blue-500');
                errorMsg.textContent = "الرجاء إدخال الأحرف العربية فقط";
                errorMsg.classList.remove('hidden');
            } else {
                input.classList.remove('border-red-500', 'bg-red-50');
                input.classList.add('border-gray-300', 'focus:border-blue-500');
                errorMsg.classList.add('hidden');
            }
        });

        document.getElementById('student-level').addEventListener('change', function() {
            const input = this;
            const errorMsg = document.getElementById('level-error');
            if (input.value !== "") {
                input.classList.remove('border-red-500', 'bg-red-50');
                input.classList.add('border-gray-300', 'focus:border-blue-500');
                errorMsg.classList.add('hidden');
            }
        });

        // --- RANDOM INPUT GENERATION ---
        function generateRandomInputs() {
            // Q1: Random grades (3 to 8 numbers) + -1
            const countQ1 = Math.floor(Math.random() * (8 - 3 + 1)) + 3;
            let grades = [];
            for (let i = 0; i < countQ1; i++) {
                grades.push(Math.floor(Math.random() * 101)); 
            }
            grades.push(-1); 
            document.getElementById('stdin1').value = grades.join(' ');

            // Q3: 5x5 Matrix with random numbers (10-99)
            let matrixRows = [];
            for (let i = 0; i < 5; i++) {
                let row = [];
                for (let j = 0; j < 5; j++) {
                    row.push(Math.floor(Math.random() * (99 - 10 + 1)) + 10);
                }
                matrixRows.push(row.join(' '));
            }
            document.getElementById('stdin3').value = matrixRows.join('\n');

            // Q4: 10 random integers (0-9)
            let arrQ4 = [];
            for (let i = 0; i < 10; i++) {
                // Using 0-9 range so '5' appears reasonably often
                arrQ4.push(Math.floor(Math.random() * 10)); 
            }
            document.getElementById('stdin4').value = arrQ4.join(' ');
        }

        // Call immediately to set initial values
        generateRandomInputs();

        // --- GENERIC RUN CODE ---
        async function runCode(id) {
            const button = document.getElementById('run-btn-' + id);
            const outputElement = document.getElementById('output' + id);
            const statusBadge = document.getElementById('status-badge-' + id);
            const stdinElement = document.getElementById('stdin' + id);
            const stdinValue = stdinElement ? stdinElement.value : "";
            
            // Pick correct editor
            let editor;
            if (id === 1) editor = editor1;
            else if (id === 2) editor = editor2;
            else if (id === 3) editor = editor3;
            else editor = editor4;

            const code = editor.getValue();

            button.disabled = true;
            button.classList.add('opacity-50', 'cursor-not-allowed');
            statusBadge.classList.remove('hidden');
            outputElement.textContent = "Compiling and executing...";
            outputElement.classList.add('text-gray-400');
            outputElement.classList.remove('text-green-400', 'text-red-400');

            try {
                const response = await fetch('https://emkc.org/api/v2/piston/execute', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        language: "c",
                        version: "10.2.0",
                        files: [{ content: code }],
                        stdin: stdinValue
                    })
                });

                const data = await response.json();
                outputElement.classList.remove('text-gray-400');

                if (data.run) {
                    if (data.run.stderr) {
                        outputElement.textContent = `Error:\n${data.run.stderr}`;
                        outputElement.classList.add('text-red-400');
                    } else {
                        outputElement.textContent = data.run.stdout || "Program ran successfully, but produced no output.";
                        outputElement.classList.add('text-green-400');
                    }
                } else {
                    outputElement.textContent = "Error connecting to the compiler API.";
                    outputElement.classList.add('text-red-400');
                }
            } catch (error) {
                outputElement.textContent = "Network Error: " + error.message;
                outputElement.classList.add('text-red-400');
            } finally {
                button.disabled = false;
                button.classList.remove('opacity-50', 'cursor-not-allowed');
                statusBadge.classList.add('hidden');
            }
        }

        // --- GENERIC FORMAT CODE ---
        function formatCode(id) {
            let editor;
            if (id === 1) editor = editor1;
            else if (id === 2) editor = editor2;
            else if (id === 3) editor = editor3;
            else editor = editor4;

            const code = editor.getValue();
            const lines = code.split('\n');
            let indent = 0;
            const indentSize = 4;
            
            const formattedLines = lines.map(line => {
                let trimmed = line.trim();
                if (!trimmed) return '';
                const clean = trimmed.replace(/\/\/.*$/, '').replace(/"(?:[^"\\]|\\.)*"/g, '');
                const openBraces = (clean.match(/{/g) || []).length;
                const closeBraces = (clean.match(/}/g) || []).length;
                
                let printIndent = indent;
                if (trimmed.startsWith('}') || trimmed.startsWith('case ') || trimmed.startsWith('default:')) {
                    printIndent = Math.max(0, printIndent - 1);
                }

                const outputLine = ' '.repeat(printIndent * indentSize) + trimmed;
                indent += (openBraces - closeBraces);
                if (indent < 0) indent = 0;
                return outputLine;
            });

            editor.setValue(formattedLines.join('\n'));
            editor.clearSelection(); 
        }

        // --- PREPARE PRINT CONTENT ---
        function prepareAndPrint() {
            // Validation
            const nameInput = document.getElementById('student-name');
            const nameError = document.getElementById('name-error');
            const nameValue = nameInput.value.trim();
            const arabicRegex = /^[\u0600-\u06FF\s]+$/;

            const levelInput = document.getElementById('student-level');
            const levelError = document.getElementById('level-error');
            const levelValue = levelInput.value;

            // Reset
            nameInput.classList.remove('border-red-500', 'bg-red-50');
            nameError.classList.add('hidden');
            levelInput.classList.remove('border-red-500', 'bg-red-50');
            levelError.classList.add('hidden');

            let isValid = true;

            if (!nameValue) {
                nameInput.classList.add('border-red-500', 'bg-red-50');
                nameError.textContent = "الرجاء إدخال اسم الطالب";
                nameError.classList.remove('hidden');
                nameInput.focus();
                isValid = false;
            } else if (!arabicRegex.test(nameValue)) {
                nameInput.classList.add('border-red-500', 'bg-red-50');
                nameError.textContent = "الرجاء إدخال الأحرف العربية فقط";
                nameError.classList.remove('hidden');
                nameInput.focus();
                isValid = false;
            }

            if (!levelValue) {
                levelInput.classList.add('border-red-500', 'bg-red-50');
                levelError.classList.remove('hidden');
                if (isValid) levelInput.focus();
                isValid = false;
            }

            if (!isValid) return;

            // --- POPULATE PRINT VIEW ---
            
            // Student Info
            document.getElementById('print-student-name').textContent = nameValue;
            document.getElementById('print-student-level').textContent = levelValue;

            // Helper to generate syntax-highlighted HTML
            const getHighlightedHtml = (editorInstance) => {
                const session = editorInstance.session;
                const length = session.getLength();
                let html = "";
                const escapeHtml = (text) => text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");

                for(let r=0; r < length; r++) {
                    const tokens = session.getTokens(r);
                    tokens.forEach(token => {
                        const typeClass = "ace_" + token.type.replace(/\./g, " ace_");
                        html += `<span class="${typeClass}">${escapeHtml(token.value)}</span>`;
                    });
                    html += "\n";
                }
                return html;
            };

            // Q1 Data
            document.getElementById('print-question-content-1').innerHTML = document.getElementById('question-text-1').innerHTML;
            document.getElementById('print-code-content-1').innerHTML = getHighlightedHtml(editor1);
            document.getElementById('print-input-content-1').textContent = document.getElementById('stdin1').value;
            document.getElementById('print-output-content-1').textContent = document.getElementById('output1').textContent;

            // Q2 Data
            document.getElementById('print-question-content-2').innerHTML = document.getElementById('question-text-2').innerHTML;
            document.getElementById('print-code-content-2').innerHTML = getHighlightedHtml(editor2);
            document.getElementById('print-output-content-2').textContent = document.getElementById('output2').textContent;

            // Q3 Data
            document.getElementById('print-question-content-3').innerHTML = document.getElementById('question-text-3').innerHTML;
            document.getElementById('print-code-content-3').innerHTML = getHighlightedHtml(editor3);
            document.getElementById('print-input-content-3').textContent = document.getElementById('stdin3').value;
            document.getElementById('print-output-content-3').textContent = document.getElementById('output3').textContent;

            // Q4 Data
            document.getElementById('print-question-content-4').innerHTML = document.getElementById('question-text-4').innerHTML;
            document.getElementById('print-code-content-4').innerHTML = getHighlightedHtml(editor4);
            document.getElementById('print-input-content-4').textContent = document.getElementById('stdin4').value;
            document.getElementById('print-output-content-4').textContent = document.getElementById('output4').textContent;

            window.print();
        }
    </script>
</body>
</html>